import{j as e,b as g,r,a as w}from"./app-Crq4IqDG.js";import{u as C}from"./useTrans-BkTq1qdy.js";import{P as h}from"./PrimaryButton-DUGJsB9S.js";import{S as p}from"./SecondaryButton-DqvnBBlG.js";import S from"./EmailTestModal-C1QZ4gbp.js";import"./AppModal-1RBzzvFe.js";function b({className:l="",disabled:s,children:t,...n}){return e.jsx("button",{...n,className:`inline-flex items-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-xs font-semibold uppercase tracking-widest text-white transition duration-150 ease-in-out hover:bg-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 active:bg-red-700 dark:focus:ring-offset-gray-800 ${s&&"opacity-25"} `+l,disabled:s,children:t})}function P({className:l=""}){const{t:s}=C();g().props.auth.user;const[t,n]=r.useState(!1),{hasGmailConnected:j,hasMicrosoftConnected:y}=g().props,[c,N]=r.useState({google:j||!1,microsoft:y||!1}),[k,d]=r.useState(!1),[v,m]=r.useState(null),x=a=>{n(!0),window.location.href=route("connections.connect",{provider:a})},f=a=>{confirm(s("confirm_disconnect_provider",{provider:a==="google"?"Gmail":"Outlook"}))&&w.delete(route("connections.disconnect",{provider:a}),{onStart:()=>n(!0),onFinish:()=>n(!1),onSuccess:()=>{N(i=>({...i,[a]:!1}))}})},u=async a=>{try{n(!0);const o=await(await fetch(route("connections.test",{provider:a}))).json();o.success&&o.data?(m(o.data),d(!0)):o.success?alert(`✅ ${o.message}`):alert(`❌ Test Failed: ${o.message}`)}catch(i){console.error("Test connection failed:",i),alert("❌ Connection test failed. Please try again.")}finally{n(!1)}},_=()=>{d(!1),m(null)};return e.jsxs("section",{className:l,children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:s("email_connections")}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:s("connect_email_accounts_description")})]}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"fab fa-google text-2xl text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Gmail"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c.google?s("connected"):s("not_connected")})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:c.google?e.jsxs(e.Fragment,{children:[e.jsx(p,{type:"button",onClick:()=>u("google"),disabled:t,icon:"fa-envelope-open-text",className:"min-w-[180px]",children:s("fetch_latest_email")}),e.jsx(b,{type:"button",onClick:()=>f("google"),disabled:t,icon:"fa-unlink",className:"min-w-[180px]",children:s("disconnect")})]}):e.jsx(h,{type:"button",onClick:()=>x("google"),disabled:t,icon:"fa-link",className:"min-w-[180px]",children:s("connect_gmail")})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"fab fa-microsoft text-2xl text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Outlook"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c.microsoft?s("connected"):s("not_connected")})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:c.microsoft?e.jsxs(e.Fragment,{children:[e.jsx(p,{type:"button",onClick:()=>u("microsoft"),disabled:t,icon:"fa-envelope-open-text",className:"min-w-[180px]",children:s("fetch_latest_email")}),e.jsx(b,{type:"button",onClick:()=>f("microsoft"),disabled:t,icon:"fa-unlink",className:"min-w-[180px]",children:s("disconnect")})]}):e.jsx(h,{type:"button",onClick:()=>x("microsoft"),disabled:t,icon:"fa-link",className:"min-w-[180px]",children:s("connect_outlook")})})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"fas fa-info-circle text-blue-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:s("about_email_connections")}),e.jsx("div",{className:"mt-2 text-sm text-blue-700 dark:text-blue-300",children:e.jsx("p",{children:s("email_connections_description")})})]})]})}),e.jsx(S,{isOpen:k,onClose:_,emailData:v})]})}export{P as default};
