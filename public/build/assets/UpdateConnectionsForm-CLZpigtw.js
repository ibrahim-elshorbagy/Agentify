import{j as e,b as d,r,a as C}from"./app-BQL--bpA.js";import{u as S}from"./useTrans-BkTq1qdy.js";import{P as h}from"./PrimaryButton-ckojlovI.js";import{S as b}from"./SecondaryButton-DBY2RSdQ.js";import E from"./EmailTestModal-CYwN3hQA.js";import"./AppModal-B31MyI1_.js";function j({className:l="",disabled:s,children:m,...t}){return e.jsx("button",{...t,className:`inline-flex items-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-xs font-semibold uppercase tracking-widest text-white transition duration-150 ease-in-out hover:bg-red-500 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 active:bg-red-700 dark:focus:ring-offset-gray-800 ${s&&"opacity-25"} `+l,disabled:s,children:m})}function B({className:l=""}){const{t:s}=S();d().props.auth.user;const{flash:m}=d().props,[t,o]=r.useState(!1),{hasGmailConnected:y,hasMicrosoftConnected:N}=d().props,[c,k]=r.useState({google:y||!1,microsoft:N||!1}),[v,x]=r.useState(!1),[_,f]=r.useState(null),u=n=>{o(!0),window.location.href=route("connections.connect",{provider:n})},p=n=>{confirm(s("confirm_disconnect_provider",{provider:n==="google"?"Gmail":"Outlook"}))&&C.delete(route("connections.disconnect",{provider:n}),{onStart:()=>o(!0),onFinish:()=>o(!1),onSuccess:()=>{k(i=>({...i,[n]:!1}))}})},g=async n=>{try{o(!0);const a=await(await fetch(route("connections.test",{provider:n}))).json();a.success&&a.data?(f(a.data),x(!0)):a.success?alert(`✅ ${a.message}`):alert(`❌ Test Failed: ${a.message}`)}catch(i){console.error("Test connection failed:",i),alert("❌ Connection test failed. Please try again.")}finally{o(!1)}},w=()=>{x(!1),f(null)};return e.jsxs("section",{className:l,children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 dark:text-gray-100",children:s("email_connections")}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:s("connect_email_accounts_description")})]}),e.jsxs("div",{className:"mt-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"fab fa-google text-2xl text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Gmail"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c.google?s("connected"):s("not_connected")})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:c.google?e.jsxs(e.Fragment,{children:[e.jsx(b,{type:"button",onClick:()=>g("google"),disabled:t,icon:"fa-envelope-open-text",className:"min-w-[180px]",children:s("fetch_latest_email")}),e.jsx(j,{type:"button",onClick:()=>p("google"),disabled:t,icon:"fa-unlink",className:"min-w-[180px]",children:s("disconnect")})]}):e.jsx(h,{type:"button",onClick:()=>u("google"),disabled:t,icon:"fa-link",className:"min-w-[180px]",children:s("connect_gmail")})})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"fab fa-microsoft text-2xl text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:"Outlook"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c.microsoft?s("connected"):s("not_connected")})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:c.microsoft?e.jsxs(e.Fragment,{children:[e.jsx(b,{type:"button",onClick:()=>g("microsoft"),disabled:t,icon:"fa-envelope-open-text",className:"min-w-[180px]",children:s("fetch_latest_email")}),e.jsx(j,{type:"button",onClick:()=>p("microsoft"),disabled:t,icon:"fa-unlink",className:"min-w-[180px]",children:s("disconnect")})]}):e.jsx(h,{type:"button",onClick:()=>u("microsoft"),disabled:t,icon:"fa-link",className:"min-w-[180px]",children:s("connect_outlook")})})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:"fas fa-info-circle text-blue-400"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:s("about_email_connections")}),e.jsx("div",{className:"mt-2 text-sm text-blue-700 dark:text-blue-300",children:e.jsx("p",{children:s("email_connections_description")})})]})]})}),e.jsx(E,{isOpen:v,onClose:w,emailData:_})]})}export{B as default};
